# Миграции базы данных

Проект использует Alembic для управления миграциями базы данных.

## Установка

Миграции уже настроены. Alembic добавлен в зависимости проекта.

## Основные команды

### Применить все миграции

```bash
uv run alembic upgrade head
```

### Откатить последнюю миграцию

```bash
uv run alembic downgrade -1
```

### Откатить все миграции

```bash
uv run alembic downgrade base
```

### Создать новую миграцию

```bash
uv run alembic revision --autogenerate -m "Описание изменений"
```

### Просмотреть текущую версию

```bash
uv run alembic current
```

### Просмотреть историю миграций

```bash
uv run alembic history
```

## Инициализация базы данных

При первом запуске или для применения всех миграций:

```bash
python init_db.py
```

Или через Alembic напрямую:

```bash
uv run alembic upgrade head
```

## Структура миграций

- `alembic/` - директория с конфигурацией Alembic
- `alembic/versions/` - директория с файлами миграций
- `alembic.ini` - конфигурационный файл Alembic

## Создание пользователя по умолчанию

Начальная миграция автоматически создает пользователя с ID `00000000-0000-0000-0000-000000000001` (user1).

## Примечания

- Миграции используют переменные окружения для подключения к БД (см. `database.py`)
- При изменении моделей создавайте новую миграцию через `alembic revision --autogenerate`
- Всегда проверяйте сгенерированные миграции перед применением

